<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detection Engineering for Incident Response - Detection Engineering Mastery</title>
    <link rel="stylesheet" href="../../css/main.css">
</head>
<body>
    <div class="layout">
        <nav class="sidebar">
            <div class="sidebar-header">
                <a href="../../index.html" class="logo">
                    <svg class="logo-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5z"></path><path d="M2 17l10 5 10-5"></path><path d="M2 12l10 5 10-5"></path></svg>
                    <span>Detection Engineering</span>
                </a>
            </div>
            <div class="nav-sections">
                <div class="nav-section " data-section="detection-engineering">
                    <div class="nav-section-header">
                        <div class="nav-section-title">
                            <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg>
                            <span>Detection Engineering</span>
                        </div>
                        <svg class="nav-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg>
                    </div>
                    <div class="nav-items">
                        <a href="../detection-engineering/fundamentals.html" class="nav-item ">Detection Fundamentals</a>
                        <a href="../detection-engineering/sentinel-deep-dive.html" class="nav-item ">Microsoft Sentinel</a>
                        <a href="../detection-engineering/splunk-comparison.html" class="nav-item ">Splunk Comparison</a>
                        <a href="../detection-engineering/detection-logic.html" class="nav-item ">Detection Logic</a>
                        <a href="../detection-engineering/mitre-mapping.html" class="nav-item ">MITRE ATT&CK Mapping</a>
                        <a href="../detection-engineering/use-case-framework.html" class="nav-item ">Use Case Framework</a>
                        <a href="../detection-engineering/metrics-optimization.html" class="nav-item ">Metrics & Optimization</a>
                    </div>
                </div>
                <div class="nav-section " data-section="log-analysis">
                    <div class="nav-section-header">
                        <div class="nav-section-title">
                            <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline></svg>
                            <span>Log Analysis</span>
                        </div>
                        <svg class="nav-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg>
                    </div>
                    <div class="nav-items">
                        <a href="../log-analysis/fundamentals.html" class="nav-item ">Log Fundamentals</a>
                        <a href="../log-analysis/network-logs.html" class="nav-item ">Network Logs</a>
                        <a href="../log-analysis/endpoint-logs.html" class="nav-item ">Endpoint Logs</a>
                        <a href="../log-analysis/cloud-logs.html" class="nav-item ">Cloud Logs</a>
                        <a href="../log-analysis/identity-logs.html" class="nav-item ">Identity Logs</a>
                        <a href="../log-analysis/data-models.html" class="nav-item ">Data Models</a>
                    </div>
                </div>
                <div class="nav-section " data-section="threat-intel">
                    <div class="nav-section-header">
                        <div class="nav-section-title">
                            <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>
                            <span>Threat Intelligence</span>
                        </div>
                        <svg class="nav-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg>
                    </div>
                    <div class="nav-items">
                        <a href="../threat-intel/fundamentals.html" class="nav-item ">TI Fundamentals</a>
                        <a href="../threat-intel/sources.html" class="nav-item ">Intelligence Sources</a>
                        <a href="../threat-intel/ioc-management.html" class="nav-item ">IOC Management</a>
                        <a href="../threat-intel/threat-hunting.html" class="nav-item ">Threat Hunting</a>
                        <a href="../threat-intel/hunting-methodology.html" class="nav-item ">Hunting Methodology</a>
                        <a href="../threat-intel/hunting-techniques.html" class="nav-item ">Hunting Techniques</a>
                        <a href="../threat-intel/hunting-queries.html" class="nav-item ">Hunting Queries</a>
                        <a href="../threat-intel/mitre-framework.html" class="nav-item ">MITRE Deep Dive</a>
                    </div>
                </div>
                <div class="nav-section " data-section="sap-security">
                    <div class="nav-section-header">
                        <div class="nav-section-title">
                            <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect><line x1="8" y1="21" x2="16" y2="21"></line><line x1="12" y1="17" x2="12" y2="21"></line></svg>
                            <span>SAP Security</span>
                        </div>
                        <svg class="nav-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg>
                    </div>
                    <div class="nav-items">
                        <a href="../sap-security/sap-overview.html" class="nav-item ">SAP Overview</a>
                        <a href="../sap-security/architecture.html" class="nav-item ">Architecture</a>
                        <a href="../sap-security/modules-services.html" class="nav-item ">Modules & Services</a>
                        <a href="../sap-security/security-fundamentals.html" class="nav-item ">Security Fundamentals</a>
                        <a href="../sap-security/log-types.html" class="nav-item ">Log Types</a>
                        <a href="../sap-security/threat-detection.html" class="nav-item ">Threat Detection</a>
                        <a href="../sap-security/siem-integration.html" class="nav-item ">SIEM Integration</a>
                        <a href="../sap-security/compliance.html" class="nav-item ">Compliance</a>
                    </div>
                </div>
                <div class="nav-section " data-section="vulnerability-mgmt">
                    <div class="nav-section-header">
                        <div class="nav-section-title">
                            <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
                            <span>Vulnerability Management</span>
                        </div>
                        <svg class="nav-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg>
                    </div>
                    <div class="nav-items">
                        <a href="../vulnerability-mgmt/fundamentals.html" class="nav-item ">VM Fundamentals</a>
                        <a href="../vulnerability-mgmt/scanning.html" class="nav-item ">Scanning</a>
                        <a href="../vulnerability-mgmt/qualys-deep-dive.html" class="nav-item ">Qualys Deep Dive</a>
                        <a href="../vulnerability-mgmt/tenable.html" class="nav-item ">Tenable/Nessus</a>
                        <a href="../vulnerability-mgmt/prioritization.html" class="nav-item ">Prioritization</a>
                        <a href="../vulnerability-mgmt/remediation.html" class="nav-item ">Remediation</a>
                        <a href="../vulnerability-mgmt/metrics.html" class="nav-item ">VM Metrics</a>
                        <a href="../vulnerability-mgmt/automation.html" class="nav-item ">VM Automation</a>
                    </div>
                </div>
                <div class="nav-section " data-section="cloud-security">
                    <div class="nav-section-header">
                        <div class="nav-section-title">
                            <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"></path></svg>
                            <span>Cloud Security</span>
                        </div>
                        <svg class="nav-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg>
                    </div>
                    <div class="nav-items">
                        <a href="../cloud-security/fundamentals.html" class="nav-item ">Cloud Fundamentals</a>
                        <a href="../cloud-security/aws-security.html" class="nav-item ">AWS Security</a>
                        <a href="../cloud-security/azure-security.html" class="nav-item ">Azure Security</a>
                        <a href="../cloud-security/gcp-security.html" class="nav-item ">GCP Security</a>
                        <a href="../cloud-security/multi-cloud.html" class="nav-item ">Multi-Cloud</a>
                        <a href="../cloud-security/cspm.html" class="nav-item ">CSPM & CWPP</a>
                    </div>
                </div>
                <div class="nav-section " data-section="automation">
                    <div class="nav-section-header">
                        <div class="nav-section-title">
                            <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline></svg>
                            <span>Automation</span>
                        </div>
                        <svg class="nav-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg>
                    </div>
                    <div class="nav-items">
                        <a href="../automation/fundamentals.html" class="nav-item ">Automation Fundamentals</a>
                        <a href="../automation/python-security.html" class="nav-item ">Python for Security</a>
                        <a href="../automation/powershell-security.html" class="nav-item ">PowerShell</a>
                        <a href="../automation/bash-security.html" class="nav-item ">Bash Scripting</a>
                        <a href="../automation/soar.html" class="nav-item ">SOAR Platforms</a>
                        <a href="../automation/api-integration.html" class="nav-item ">API Integration</a>
                    </div>
                </div>
                <div class="nav-section " data-section="compliance">
                    <div class="nav-section-header">
                        <div class="nav-section-title">
                            <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
                            <span>Compliance</span>
                        </div>
                        <svg class="nav-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg>
                    </div>
                    <div class="nav-items">
                        <a href="../compliance/framework-overview.html" class="nav-item ">Framework Overview</a>
                        <a href="../compliance/iso-27001.html" class="nav-item ">ISO 27001</a>
                        <a href="../compliance/nist-csf.html" class="nav-item ">NIST CSF</a>
                        <a href="../compliance/nist-800-53.html" class="nav-item ">NIST 800-53</a>
                        <a href="../compliance/gdpr.html" class="nav-item ">GDPR</a>
                        <a href="../compliance/other-frameworks.html" class="nav-item ">Other Frameworks</a>
                        <a href="../compliance/documentation.html" class="nav-item ">Documentation</a>
                    </div>
                </div>
                <div class="nav-section expanded" data-section="incident-response">
                    <div class="nav-section-header">
                        <div class="nav-section-title">
                            <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>
                            <span>Incident Response</span>
                        </div>
                        <svg class="nav-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg>
                    </div>
                    <div class="nav-items">
                        <a href="../incident-response/soc-collaboration.html" class="nav-item ">SOC Collaboration</a>
                        <a href="../incident-response/ir-support.html" class="nav-item active">IR Support</a>
                        <a href="../incident-response/forensics.html" class="nav-item ">Forensics</a>
                        <a href="../incident-response/communication.html" class="nav-item ">Communication</a>
                    </div>
                </div>
                <div class="nav-section " data-section="references">
                    <div class="nav-section-header">
                        <div class="nav-section-title">
                            <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg>
                            <span>Quick Reference</span>
                        </div>
                        <svg class="nav-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg>
                    </div>
                    <div class="nav-items">
                        <a href="../references/kql-cheatsheet.html" class="nav-item ">KQL Cheatsheet</a>
                        <a href="../references/spl-cheatsheet.html" class="nav-item ">SPL Cheatsheet</a>
                        <a href="../references/regex-mastery.html" class="nav-item ">Regex Reference</a>
                        <a href="../references/windows-events.html" class="nav-item ">Windows Events</a>
                        <a href="../references/mitre-quick-ref.html" class="nav-item ">MITRE Quick Ref</a>
                        <a href="../references/interview-prep.html" class="nav-item ">Interview Prep</a>
                        <a href="../references/interview-answers.html" class="nav-item ">My Interview Answers</a>
                    </div>
                </div>
            </div>
        </nav>

        <main class="main-content">
            <div class="content">
                <nav class="breadcrumb">
                    <a href="../../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="ir-support.html">Incident Response</a>
                    <span class="separator">/</span>
                    <span class="current">Detection Engineering for Incident Response</span>
                </nav>

                <header class="page-header">
                    <h1>Detection Engineering for Incident Response</h1>
                    <p class="subtitle">How detection engineers support incident response with rapid query development, threat hunting, and post-incident detection improvements.</p>
                </header>

                <section class="content-section">
                    <h2>Detection Engineer's Role in IR</h2>
                    
                    <p>Detection engineers play a critical role during incidentsâ€”rapidly developing queries, hunting for lateral movement, and creating detections to prevent recurrence.</p>

                    <div class="comparison-grid">
                        <div class="comparison-card">
                            <h4>During Incident</h4>
                            <ul>
                                <li>Develop ad-hoc hunting queries</li>
                                <li>Scope compromise across environment</li>
                                <li>Identify affected systems/users</li>
                                <li>Track attacker movement</li>
                                <li>Create IOC watchlists</li>
                            </ul>
                        </div>
                        <div class="comparison-card">
                            <h4>Post-Incident</h4>
                            <ul>
                                <li>Build detections for observed TTPs</li>
                                <li>Gap analysis on missed activity</li>
                                <li>Tune existing rules</li>
                                <li>Document lessons learned</li>
                                <li>Update detection coverage</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Rapid Query Development</h2>

                    <h3>Scoping Compromise</h3>
                    <div class="code-block">
                        <div class="code-header">
                            <span>KQL - Find All Activity from Compromised Account</span>
                            <button class="copy-btn">Copy</button>
                        </div>
                        <pre><code>// Scope all activity from compromised user
let CompromisedUser = "john.doe@company.com";
let IncidentStart = datetime(2024-01-15T08:00:00Z);
let IncidentEnd = datetime(2024-01-15T18:00:00Z);
//
// Sign-in activity
let SignIns = SigninLogs
| where TimeGenerated between (IncidentStart .. IncidentEnd)
| where UserPrincipalName =~ CompromisedUser
| project TimeGenerated, Activity="SignIn", Details=strcat(AppDisplayName, " from ", IPAddress, " (", Location, ")"), Result=ResultType;
//
// Azure activity
let AzureActivity = AzureActivity
| where TimeGenerated between (IncidentStart .. IncidentEnd)
| where Caller =~ CompromisedUser
| project TimeGenerated, Activity="AzureAPI", Details=OperationNameValue, Result=ActivityStatusValue;
//
// Office 365 activity
let O365 = OfficeActivity
| where TimeGenerated between (IncidentStart .. IncidentEnd)
| where UserId =~ CompromisedUser
| project TimeGenerated, Activity="Office365", Details=Operation, Result=ResultStatus;
//
// Endpoint activity
let Endpoint = DeviceLogonEvents
| where TimeGenerated between (IncidentStart .. IncidentEnd)
| where AccountName has CompromisedUser
| project TimeGenerated, Activity="EndpointLogon", Details=strcat(DeviceName, " - ", LogonType), Result=ActionType;
//
union SignIns, AzureActivity, O365, Endpoint
| sort by TimeGenerated asc
| project TimeGenerated, Activity, Details, Result</code></pre>
                    </div>

                    <h3>Find Lateral Movement</h3>
                    <div class="code-block">
                        <div class="code-header">
                            <span>KQL - Track Lateral Movement from Initial Host</span>
                            <button class="copy-btn">Copy</button>
                        </div>
                        <pre><code>// Track lateral movement from patient zero
let PatientZero = "WORKSTATION01";
let IncidentStart = datetime(2024-01-15T08:00:00Z);
//
// Network connections from compromised host
let OutboundConnections = DeviceNetworkEvents
| where TimeGenerated > IncidentStart
| where DeviceName =~ PatientZero
| where RemoteIPType == "Private"
| summarize 
    FirstSeen = min(TimeGenerated),
    LastSeen = max(TimeGenerated),
    Connections = count()
    by RemoteIP, RemotePort
| extend TargetHost = RemoteIP;
//
// Logon events TO other systems FROM compromised user
let LateralLogons = DeviceLogonEvents
| where TimeGenerated > IncidentStart
| where LogonType in ("Network", "RemoteInteractive", "NewCredentials")
| where InitiatingProcessAccountName != "-"
| join kind=inner (
    DeviceLogonEvents
    | where DeviceName =~ PatientZero
    | distinct AccountName
) on $left.AccountName == $right.AccountName
| where DeviceName != PatientZero
| summarize 
    FirstLogon = min(TimeGenerated),
    LogonCount = count()
    by DeviceName, AccountName, LogonType;
//
// Visualize spread
LateralLogons
| project TimeGenerated=FirstLogon, TargetHost=DeviceName, User=AccountName, Method=LogonType
| sort by TimeGenerated asc</code></pre>
                    </div>

                    <h3>Hunt for Specific IOCs</h3>
                    <div class="code-block">
                        <div class="code-header">
                            <span>KQL - Search for IOCs Across Data Sources</span>
                            <button class="copy-btn">Copy</button>
                        </div>
                        <pre><code>// Hunt for known IOCs across all data
let MaliciousIPs = dynamic(["198.51.100.1", "203.0.113.50", "192.0.2.100"]);
let MaliciousDomains = dynamic(["evil.com", "malware.net", "c2server.xyz"]);
let MaliciousHashes = dynamic(["d41d8cd98f00b204e9800998ecf8427e", "e3b0c44298fc1c149afbf4c8996fb924"]);
//
// Network IOCs
let NetworkHits = DeviceNetworkEvents
| where RemoteIP in (MaliciousIPs) or RemoteUrl has_any (MaliciousDomains)
| project TimeGenerated, Source="Network", Device=DeviceName, IOC=coalesce(RemoteIP, RemoteUrl), Details=strcat(InitiatingProcessFileName, " -> ", RemotePort);
//
// DNS IOCs
let DNSHits = DnsEvents
| where Name has_any (MaliciousDomains)
| project TimeGenerated, Source="DNS", Device=Computer, IOC=Name, Details=strcat("Query from ", ClientIP);
//
// File Hash IOCs
let FileHits = DeviceFileEvents
| where SHA256 in (MaliciousHashes) or MD5 in (MaliciousHashes)
| project TimeGenerated, Source="FileHash", Device=DeviceName, IOC=coalesce(SHA256, MD5), Details=FileName;
//
// Process IOCs
let ProcessHits = DeviceProcessEvents
| where SHA256 in (MaliciousHashes) or MD5 in (MaliciousHashes)
| project TimeGenerated, Source="Process", Device=DeviceName, IOC=coalesce(SHA256, MD5), Details=strcat(FileName, " - ", ProcessCommandLine);
//
union NetworkHits, DNSHits, FileHits, ProcessHits
| sort by TimeGenerated desc</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Timeline Construction</h2>

                    <div class="code-block">
                        <div class="code-header">
                            <span>KQL - Build Attack Timeline</span>
                            <button class="copy-btn">Copy</button>
                        </div>
                        <pre><code>// Construct incident timeline from multiple sources
let IncidentStart = datetime(2024-01-15T00:00:00Z);
let IncidentEnd = datetime(2024-01-16T00:00:00Z);
let SuspiciousEntities = dynamic(["john.doe@company.com", "WORKSTATION01", "198.51.100.1"]);
//
// Collect events from all sources
let Timeline = union
    // Sign-ins
    (SigninLogs
    | where TimeGenerated between (IncidentStart .. IncidentEnd)
    | where UserPrincipalName in (SuspiciousEntities) or IPAddress in (SuspiciousEntities)
    | extend EventType = "Authentication", 
             Source = "EntraID",
             Actor = UserPrincipalName,
             Target = AppDisplayName,
             Details = strcat("From ", IPAddress, " - ", ResultType)),
    // Endpoint processes
    (DeviceProcessEvents
    | where TimeGenerated between (IncidentStart .. IncidentEnd)
    | where DeviceName in (SuspiciousEntities) or InitiatingProcessAccountName has_any (SuspiciousEntities)
    | extend EventType = "ProcessExecution",
             Source = "MDE",
             Actor = InitiatingProcessAccountName,
             Target = DeviceName,
             Details = strcat(FileName, " - ", ProcessCommandLine)),
    // File events
    (DeviceFileEvents
    | where TimeGenerated between (IncidentStart .. IncidentEnd)
    | where DeviceName in (SuspiciousEntities)
    | where ActionType in ("FileCreated", "FileModified")
    | extend EventType = "FileActivity",
             Source = "MDE",
             Actor = InitiatingProcessAccountName,
             Target = DeviceName,
             Details = strcat(ActionType, ": ", FolderPath, "\\", FileName)),
    // Network connections
    (DeviceNetworkEvents
    | where TimeGenerated between (IncidentStart .. IncidentEnd)
    | where DeviceName in (SuspiciousEntities) or RemoteIP in (SuspiciousEntities)
    | extend EventType = "NetworkConnection",
             Source = "MDE",
             Actor = DeviceName,
             Target = RemoteIP,
             Details = strcat(InitiatingProcessFileName, " -> ", RemoteIP, ":", RemotePort))
| project TimeGenerated, EventType, Source, Actor, Target, Details
| sort by TimeGenerated asc;
//
Timeline</code></pre>
                    </div>

                    <div class="info-box tip">
                        <h4>ðŸ’¡ Timeline Best Practices</h4>
                        <ul>
                            <li>Normalize timestamps to UTC</li>
                            <li>Include source system for each event</li>
                            <li>Add context (success/failure, severity)</li>
                            <li>Export to CSV for IR team and legal</li>
                            <li>Highlight key attacker actions</li>
                        </ul>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Post-Incident Detection Development</h2>

                    <h3>Gap Analysis Process</h3>
                    <div class="comparison-grid">
                        <div class="comparison-card">
                            <h4>1. Map Attacker TTPs</h4>
                            <ul>
                                <li>Document observed techniques</li>
                                <li>Map to MITRE ATT&CK</li>
                                <li>Identify kill chain stages</li>
                            </ul>
                        </div>
                        <div class="comparison-card">
                            <h4>2. Review Detection Coverage</h4>
                            <ul>
                                <li>Which TTPs were detected?</li>
                                <li>Which were missed?</li>
                                <li>What was detection latency?</li>
                            </ul>
                        </div>
                        <div class="comparison-card">
                            <h4>3. Build New Detections</h4>
                            <ul>
                                <li>Create rules for missed TTPs</li>
                                <li>Tune existing rules</li>
                                <li>Add IOC-based detections</li>
                            </ul>
                        </div>
                    </div>

                    <h3>Example: Post-Incident Detection</h3>
                    <div class="code-block">
                        <div class="code-header">
                            <span>Detection Built from IR Findings</span>
                            <button class="copy-btn">Copy</button>
                        </div>
                        <pre><code>// Detection: Attacker used certutil for download (observed in incident)
// MITRE: T1105 - Ingress Tool Transfer
DeviceProcessEvents
| where FileName =~ "certutil.exe"
| where ProcessCommandLine has_any ("-urlcache", "-split", "-f", "http://", "https://")
| where ProcessCommandLine !has "Microsoft"  // Exclude legit Windows Update
| project 
    TimeGenerated,
    DeviceName,
    AccountName = InitiatingProcessAccountName,
    CommandLine = ProcessCommandLine,
    ParentProcess = InitiatingProcessFileName
| extend AlertTitle = "Certutil Used for File Download"
| extend AlertSeverity = "High"
| extend MITRE = "T1105"
| extend IncidentReference = "INC-2024-0115"  // Link to originating incident</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Interview Preparation</h2>
                    
                    <div class="expandable">
                        <button class="expandable-header">
                            <span>Q: How do you support an active incident as a detection engineer?</span>
                            <span class="expand-icon">+</span>
                        </button>
                        <div class="expandable-content">
                            <p><strong>Immediate actions:</strong></p>
                            <ol>
                                <li><strong>Scope the compromise:</strong> Build queries to find all affected systems and users</li>
                                <li><strong>Hunt for IOCs:</strong> Search for known malicious IPs, domains, hashes across all data sources</li>
                                <li><strong>Track lateral movement:</strong> Query authentication and network logs to map attacker path</li>
                                <li><strong>Create watchlists:</strong> Add IOCs to real-time alerting</li>
                                <li><strong>Build timeline:</strong> Construct chronological view for IR team</li>
                            </ol>
                            <p><strong>Post-incident:</strong> Document TTPs, perform gap analysis, build new detections for missed activity.</p>
                        </div>
                    </div>

                    <div class="expandable">
                        <button class="expandable-header">
                            <span>Q: What's your process for improving detections after an incident?</span>
                            <span class="expand-icon">+</span>
                        </button>
                        <div class="expandable-content">
                            <p><strong>Process:</strong></p>
                            <ol>
                                <li><strong>Debrief with IR:</strong> Understand full attack chain and TTPs used</li>
                                <li><strong>Map to MITRE:</strong> Document each technique observed</li>
                                <li><strong>Review existing rules:</strong> Did we have coverage? Why didn't it alert?</li>
                                <li><strong>Root cause:</strong> Missing log source? Rule too specific? Threshold too high?</li>
                                <li><strong>Build detections:</strong> Create rules for each missed TTP</li>
                                <li><strong>Test with incident data:</strong> Replay attack data to validate detection</li>
                                <li><strong>Document:</strong> Link new detections to incident for context</li>
                            </ol>
                        </div>
                    </div>
                </section>

                <nav class="page-nav">
                    <a href="../automation/api-integration.html" class="nav-link prev">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"></polyline></svg>
                        API Integration
                    </a>
                    <a href="forensics.html" class="nav-link next">
                        Forensic Artifacts
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg>
                    </a>
                </nav>
            </div>
        </main>
    </div>
    <script src="../../js/sidebar.js"></script>
</body>
</html>