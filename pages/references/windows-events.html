<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Windows Event IDs - Detection Engineering Mastery</title>
    <link rel="stylesheet" href="../../css/main.css">
</head>
<body>
    <div class="layout">
        <nav class="sidebar">
            <div class="sidebar-header">
                <a href="../../index.html" class="logo">
                    <svg class="logo-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5z"></path><path d="M2 17l10 5 10-5"></path><path d="M2 12l10 5 10-5"></path></svg>
                    <span>Detection Engineering</span>
                </a>
            </div>
            <div class="nav-sections">
                <div class="nav-section " data-section="detection-engineering">
                    <div class="nav-section-header">
                        <div class="nav-section-title">
                            <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg>
                            <span>Detection Engineering</span>
                        </div>
                        <svg class="nav-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg>
                    </div>
                    <div class="nav-items">
                        <a href="../../pages/detection-engineering/fundamentals.html" class="nav-item ">Detection Fundamentals</a>
                        <a href="../../pages/detection-engineering/sentinel-deep-dive.html" class="nav-item ">Microsoft Sentinel</a>
                        <a href="../../pages/detection-engineering/splunk-comparison.html" class="nav-item ">Splunk Comparison</a>
                        <a href="../../pages/detection-engineering/detection-logic.html" class="nav-item ">Detection Logic</a>
                        <a href="../../pages/detection-engineering/mitre-mapping.html" class="nav-item ">MITRE ATT&CK Mapping</a>
                        <a href="../../pages/detection-engineering/use-case-framework.html" class="nav-item ">Use Case Framework</a>
                        <a href="../../pages/detection-engineering/metrics-optimization.html" class="nav-item ">Metrics & Optimization</a>
                    </div>
                </div>
                <div class="nav-section " data-section="log-analysis">
                    <div class="nav-section-header">
                        <div class="nav-section-title">
                            <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline></svg>
                            <span>Log Analysis</span>
                        </div>
                        <svg class="nav-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg>
                    </div>
                    <div class="nav-items">
                        <a href="../../pages/log-analysis/fundamentals.html" class="nav-item ">Log Fundamentals</a>
                        <a href="../../pages/log-analysis/network-logs.html" class="nav-item ">Network Logs</a>
                        <a href="../../pages/log-analysis/endpoint-logs.html" class="nav-item ">Endpoint Logs</a>
                        <a href="../../pages/log-analysis/cloud-logs.html" class="nav-item ">Cloud Logs</a>
                        <a href="../../pages/log-analysis/identity-logs.html" class="nav-item ">Identity Logs</a>
                        <a href="../../pages/log-analysis/data-models.html" class="nav-item ">Data Models</a>
                    </div>
                </div>
                <div class="nav-section " data-section="threat-intel">
                    <div class="nav-section-header">
                        <div class="nav-section-title">
                            <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>
                            <span>Threat Intelligence</span>
                        </div>
                        <svg class="nav-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg>
                    </div>
                    <div class="nav-items">
                        <a href="../../pages/threat-intel/fundamentals.html" class="nav-item ">TI Fundamentals</a>
                        <a href="../../pages/threat-intel/sources.html" class="nav-item ">Intelligence Sources</a>
                        <a href="../../pages/threat-intel/ioc-management.html" class="nav-item ">IOC Management</a>
                        <a href="../../pages/threat-intel/threat-hunting.html" class="nav-item ">Threat Hunting</a>
                        <a href="../../pages/threat-intel/hunting-methodology.html" class="nav-item ">Hunting Methodology</a>
                        <a href="../../pages/threat-intel/hunting-techniques.html" class="nav-item ">Hunting Techniques</a>
                        <a href="../../pages/threat-intel/hunting-queries.html" class="nav-item ">Hunting Queries</a>
                        <a href="../../pages/threat-intel/mitre-framework.html" class="nav-item ">MITRE Deep Dive</a>
                    </div>
                </div>
                <div class="nav-section " data-section="sap-security">
                    <div class="nav-section-header">
                        <div class="nav-section-title">
                            <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect><line x1="8" y1="21" x2="16" y2="21"></line><line x1="12" y1="17" x2="12" y2="21"></line></svg>
                            <span>SAP Security</span>
                        </div>
                        <svg class="nav-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg>
                    </div>
                    <div class="nav-items">
                        <a href="../../pages/sap-security/sap-overview.html" class="nav-item ">SAP Overview</a>
                        <a href="../../pages/sap-security/architecture.html" class="nav-item ">Architecture</a>
                        <a href="../../pages/sap-security/modules-services.html" class="nav-item ">Modules & Services</a>
                        <a href="../../pages/sap-security/security-fundamentals.html" class="nav-item ">Security Fundamentals</a>
                        <a href="../../pages/sap-security/log-types.html" class="nav-item ">Log Types</a>
                        <a href="../../pages/sap-security/threat-detection.html" class="nav-item ">Threat Detection</a>
                        <a href="../../pages/sap-security/siem-integration.html" class="nav-item ">SIEM Integration</a>
                        <a href="../../pages/sap-security/compliance.html" class="nav-item ">Compliance</a>
                    </div>
                </div>
                <div class="nav-section " data-section="vulnerability-mgmt">
                    <div class="nav-section-header">
                        <div class="nav-section-title">
                            <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
                            <span>Vulnerability Management</span>
                        </div>
                        <svg class="nav-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg>
                    </div>
                    <div class="nav-items">
                        <a href="../../pages/vulnerability-mgmt/fundamentals.html" class="nav-item ">VM Fundamentals</a>
                        <a href="../../pages/vulnerability-mgmt/scanning.html" class="nav-item ">Scanning</a>
                        <a href="../../pages/vulnerability-mgmt/qualys-deep-dive.html" class="nav-item ">Qualys Deep Dive</a>
                        <a href="../../pages/vulnerability-mgmt/tenable.html" class="nav-item ">Tenable/Nessus</a>
                        <a href="../../pages/vulnerability-mgmt/prioritization.html" class="nav-item ">Prioritization</a>
                        <a href="../../pages/vulnerability-mgmt/remediation.html" class="nav-item ">Remediation</a>
                        <a href="../../pages/vulnerability-mgmt/metrics.html" class="nav-item ">VM Metrics</a>
                        <a href="../../pages/vulnerability-mgmt/automation.html" class="nav-item ">VM Automation</a>
                    </div>
                </div>
                <div class="nav-section " data-section="cloud-security">
                    <div class="nav-section-header">
                        <div class="nav-section-title">
                            <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"></path></svg>
                            <span>Cloud Security</span>
                        </div>
                        <svg class="nav-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg>
                    </div>
                    <div class="nav-items">
                        <a href="../../pages/cloud-security/fundamentals.html" class="nav-item ">Cloud Fundamentals</a>
                        <a href="../../pages/cloud-security/aws-security.html" class="nav-item ">AWS Security</a>
                        <a href="../../pages/cloud-security/azure-security.html" class="nav-item ">Azure Security</a>
                        <a href="../../pages/cloud-security/gcp-security.html" class="nav-item ">GCP Security</a>
                        <a href="../../pages/cloud-security/multi-cloud.html" class="nav-item ">Multi-Cloud</a>
                        <a href="../../pages/cloud-security/cspm.html" class="nav-item ">CSPM & CWPP</a>
                    </div>
                </div>
                <div class="nav-section " data-section="automation">
                    <div class="nav-section-header">
                        <div class="nav-section-title">
                            <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline></svg>
                            <span>Automation</span>
                        </div>
                        <svg class="nav-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg>
                    </div>
                    <div class="nav-items">
                        <a href="../../pages/automation/fundamentals.html" class="nav-item ">Automation Fundamentals</a>
                        <a href="../../pages/automation/python-security.html" class="nav-item ">Python for Security</a>
                        <a href="../../pages/automation/powershell-security.html" class="nav-item ">PowerShell</a>
                        <a href="../../pages/automation/bash-security.html" class="nav-item ">Bash Scripting</a>
                        <a href="../../pages/automation/soar.html" class="nav-item ">SOAR Platforms</a>
                        <a href="../../pages/automation/api-integration.html" class="nav-item ">API Integration</a>
                    </div>
                </div>
                <div class="nav-section " data-section="compliance">
                    <div class="nav-section-header">
                        <div class="nav-section-title">
                            <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
                            <span>Compliance</span>
                        </div>
                        <svg class="nav-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg>
                    </div>
                    <div class="nav-items">
                        <a href="../../pages/compliance/framework-overview.html" class="nav-item ">Framework Overview</a>
                        <a href="../../pages/compliance/iso-27001.html" class="nav-item ">ISO 27001</a>
                        <a href="../../pages/compliance/nist-csf.html" class="nav-item ">NIST CSF</a>
                        <a href="../../pages/compliance/nist-800-53.html" class="nav-item ">NIST 800-53</a>
                        <a href="../../pages/compliance/gdpr.html" class="nav-item ">GDPR</a>
                        <a href="../../pages/compliance/other-frameworks.html" class="nav-item ">Other Frameworks</a>
                        <a href="../../pages/compliance/documentation.html" class="nav-item ">Documentation</a>
                    </div>
                </div>
                <div class="nav-section " data-section="incident-response">
                    <div class="nav-section-header">
                        <div class="nav-section-title">
                            <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>
                            <span>Incident Response</span>
                        </div>
                        <svg class="nav-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg>
                    </div>
                    <div class="nav-items">
                        <a href="../../pages/incident-response/soc-collaboration.html" class="nav-item ">SOC Collaboration</a>
                        <a href="../../pages/incident-response/ir-support.html" class="nav-item ">IR Support</a>
                        <a href="../../pages/incident-response/forensics.html" class="nav-item ">Forensics</a>
                        <a href="../../pages/incident-response/communication.html" class="nav-item ">Communication</a>
                    </div>
                </div>
                <div class="nav-section expanded" data-section="references">
                    <div class="nav-section-header">
                        <div class="nav-section-title">
                            <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg>
                            <span>Quick Reference</span>
                        </div>
                        <svg class="nav-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg>
                    </div>
                    <div class="nav-items">
                        <a href="../../pages/references/kql-cheatsheet.html" class="nav-item ">KQL Cheatsheet</a>
                        <a href="../../pages/references/spl-cheatsheet.html" class="nav-item ">SPL Cheatsheet</a>
                        <a href="../../pages/references/regex-mastery.html" class="nav-item ">Regex Reference</a>
                        <a href="../../pages/references/windows-events.html" class="nav-item active">Windows Events</a>
                        <a href="../../pages/references/mitre-quick-ref.html" class="nav-item ">MITRE Quick Ref</a>
                        <a href="../../pages/references/interview-prep.html" class="nav-item ">Interview Prep</a>
                        <a href="../../pages/references/interview-answers.html" class="nav-item ">My Interview Answers</a>
                    </div>
                </div>
            </div>
        </nav>

        <main class="main-content">
            <div class="content">
                <nav class="breadcrumb">
                    <a href="../../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="windows-events.html">Quick Reference</a>
                    <span class="separator">/</span>
                    <span class="current">Windows Event IDs</span>
                </nav>

                <header class="page-header">
                    <h1>Windows Event IDs</h1>
                    
                </header>

                <section class="content-section">
            <h2>Authentication Events</h2>
            <p>Authentication events are foundational for detecting unauthorized access, credential attacks, and lateral movement.</p>

            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Event ID</th>
                        <th>Event Name</th>
                        <th>Detection Use Cases</th>
                        <th>MITRE Technique</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>4624</strong></td>
                        <td>Successful Logon</td>
                        <td>Track logon patterns, detect anomalies</td>
                        <td>T1078 Valid Accounts</td>
                    </tr>
                    <tr>
                        <td><strong>4625</strong></td>
                        <td>Failed Logon</td>
                        <td>Brute force, password spray detection</td>
                        <td>T1110 Brute Force</td>
                    </tr>
                    <tr>
                        <td><strong>4634/4647</strong></td>
                        <td>Logoff</td>
                        <td>Session duration analysis</td>
                        <td>‚Äî</td>
                    </tr>
                    <tr>
                        <td><strong>4648</strong></td>
                        <td>Explicit Credentials Logon</td>
                        <td>RunAs, credential theft detection</td>
                        <td>T1078 Valid Accounts</td>
                    </tr>
                    <tr>
                        <td><strong>4672</strong></td>
                        <td>Special Privileges Assigned</td>
                        <td>Admin logon tracking</td>
                        <td>T1078 Valid Accounts</td>
                    </tr>
                    <tr>
                        <td><strong>4768</strong></td>
                        <td>Kerberos TGT Request</td>
                        <td>AS-REP roasting detection</td>
                        <td>T1558.004 AS-REP Roasting</td>
                    </tr>
                    <tr>
                        <td><strong>4769</strong></td>
                        <td>Kerberos Service Ticket</td>
                        <td>Kerberoasting detection</td>
                        <td>T1558.003 Kerberoasting</td>
                    </tr>
                    <tr>
                        <td><strong>4771</strong></td>
                        <td>Kerberos Pre-Auth Failed</td>
                        <td>Password attacks</td>
                        <td>T1110 Brute Force</td>
                    </tr>
                    <tr>
                        <td><strong>4776</strong></td>
                        <td>NTLM Authentication</td>
                        <td>Pass-the-Hash, NTLM relay</td>
                        <td>T1550.002 Pass-the-Hash</td>
                    </tr>
                </tbody>
            </table>

            <h3>Logon Type Reference</h3>
            <div class="info-box info">
                <div class="info-box-header">
                    <span class="info-icon">‚ÑπÔ∏è</span>
                    <span>Event 4624 Logon Types</span>
                </div>
                <div class="info-box-content">
                    <p><strong>Type 2:</strong> Interactive (console logon)</p>
                    <p><strong>Type 3:</strong> Network (SMB, mapped drives)</p>
                    <p><strong>Type 4:</strong> Batch (scheduled tasks)</p>
                    <p><strong>Type 5:</strong> Service (service startup)</p>
                    <p><strong>Type 7:</strong> Unlock (workstation unlock)</p>
                    <p><strong>Type 8:</strong> NetworkCleartext (IIS basic auth)</p>
                    <p><strong>Type 9:</strong> NewCredentials (RunAs /netonly)</p>
                    <p><strong>Type 10:</strong> RemoteInteractive (RDP)</p>
                    <p><strong>Type 11:</strong> CachedInteractive (cached credentials)</p>
                </div>
            </div>

            <div class="code-block" data-language="kql">
                <div class="code-header">
                    <span class="code-lang">KQL</span>
                    <span class="code-title">Authentication Analysis Query</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <pre><code>// Analyze authentication patterns
SecurityEvent
| where TimeGenerated > ago(24h)
| where EventID in (4624, 4625)
| extend 
    LogonType = tostring(LogonType),
    LogonTypeName = case(
        LogonType == "2", "Interactive",
        LogonType == "3", "Network",
        LogonType == "4", "Batch",
        LogonType == "5", "Service",
        LogonType == "7", "Unlock",
        LogonType == "8", "NetworkCleartext",
        LogonType == "9", "NewCredentials",
        LogonType == "10", "RemoteInteractive",
        LogonType == "11", "CachedInteractive",
        "Unknown"
    ),
    Status = iff(EventID == 4624, "Success", "Failure")
| summarize 
    SuccessCount = countif(Status == "Success"),
    FailureCount = countif(Status == "Failure"),
    UniqueUsers = dcount(TargetUserName),
    UniqueHosts = dcount(Computer)
    by LogonTypeName, bin(TimeGenerated, 1h)
| order by TimeGenerated desc</code></pre>
            </div>
        </section>

                <section class="content-section">
            <h2>Process Events</h2>
            <p>Process creation events are essential for detecting malicious execution, living-off-the-land techniques, and suspicious behaviors.</p>

            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Event ID</th>
                        <th>Event Name</th>
                        <th>Detection Use Cases</th>
                        <th>MITRE Technique</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>4688</strong></td>
                        <td>Process Creation</td>
                        <td>All execution monitoring (requires cmd line logging)</td>
                        <td>T1059 Command & Scripting</td>
                    </tr>
                    <tr>
                        <td><strong>4689</strong></td>
                        <td>Process Termination</td>
                        <td>Process lifetime analysis</td>
                        <td>‚Äî</td>
                    </tr>
                    <tr>
                        <td><strong>1 (Sysmon)</strong></td>
                        <td>Process Create</td>
                        <td>Enhanced process details with hashes</td>
                        <td>T1059 Command & Scripting</td>
                    </tr>
                    <tr>
                        <td><strong>5 (Sysmon)</strong></td>
                        <td>Process Terminated</td>
                        <td>Process lifecycle tracking</td>
                        <td>‚Äî</td>
                    </tr>
                    <tr>
                        <td><strong>10 (Sysmon)</strong></td>
                        <td>Process Access</td>
                        <td>LSASS access, process injection</td>
                        <td>T1003.001 LSASS Memory</td>
                    </tr>
                </tbody>
            </table>

            <div class="info-box warning">
                <div class="info-box-header">
                    <span class="info-icon">‚ö†Ô∏è</span>
                    <span>Enable Command Line Logging</span>
                </div>
                <div class="info-box-content">
                    <p>Event 4688 doesn't include command line by default. Enable via:</p>
                    <p><code>Computer Configuration ‚Üí Administrative Templates ‚Üí System ‚Üí Audit Process Creation ‚Üí Include command line in process creation events</code></p>
                </div>
            </div>

            <div class="code-block" data-language="kql">
                <div class="code-header">
                    <span class="code-lang">KQL</span>
                    <span class="code-title">Suspicious Process Execution Detection</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <pre><code>// Detect suspicious process execution patterns
SecurityEvent
| where EventID == 4688
| where TimeGenerated > ago(1h)
| extend 
    ProcessName = tostring(split(NewProcessName, "\\")[-1]),
    ParentProcess = tostring(split(ParentProcessName, "\\")[-1])
| where ProcessName in~ (
    "powershell.exe", "pwsh.exe", "cmd.exe",
    "wscript.exe", "cscript.exe", "mshta.exe",
    "certutil.exe", "bitsadmin.exe", "regsvr32.exe"
)
| extend 
    SuspiciousIndicators = strcat(
        iff(CommandLine has_any ("-enc", "-encoded"), "Encoded ", ""),
        iff(CommandLine has_any ("http://", "https://"), "Network ", ""),
        iff(CommandLine has "hidden", "Hidden ", ""),
        iff(ParentProcess in~ ("winword.exe", "excel.exe", "outlook.exe"), "OfficeChild ", "")
    )
| where isnotempty(SuspiciousIndicators)
| project 
    TimeGenerated,
    Computer,
    Account,
    ProcessName,
    CommandLine,
    ParentProcess,
    SuspiciousIndicators</code></pre>
            </div>
        </section>

                <section class="content-section">
            <h2>Account Management Events</h2>
            <p>Track account creation, modification, and privilege changes to detect persistence and privilege escalation.</p>

            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Event ID</th>
                        <th>Event Name</th>
                        <th>Detection Use Cases</th>
                        <th>MITRE Technique</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>4720</strong></td>
                        <td>User Account Created</td>
                        <td>Unauthorized account creation</td>
                        <td>T1136 Create Account</td>
                    </tr>
                    <tr>
                        <td><strong>4722</strong></td>
                        <td>User Account Enabled</td>
                        <td>Dormant account reactivation</td>
                        <td>T1078 Valid Accounts</td>
                    </tr>
                    <tr>
                        <td><strong>4723</strong></td>
                        <td>Password Change Attempt</td>
                        <td>Self-service password changes</td>
                        <td>‚Äî</td>
                    </tr>
                    <tr>
                        <td><strong>4724</strong></td>
                        <td>Password Reset Attempt</td>
                        <td>Admin password resets</td>
                        <td>T1098 Account Manipulation</td>
                    </tr>
                    <tr>
                        <td><strong>4725</strong></td>
                        <td>User Account Disabled</td>
                        <td>Account lifecycle management</td>
                        <td>‚Äî</td>
                    </tr>
                    <tr>
                        <td><strong>4726</strong></td>
                        <td>User Account Deleted</td>
                        <td>Anti-forensics, cleanup</td>
                        <td>T1070 Indicator Removal</td>
                    </tr>
                    <tr>
                        <td><strong>4728</strong></td>
                        <td>Member Added to Security Group</td>
                        <td>Privilege escalation</td>
                        <td>T1098 Account Manipulation</td>
                    </tr>
                    <tr>
                        <td><strong>4732</strong></td>
                        <td>Member Added to Local Group</td>
                        <td>Local admin addition</td>
                        <td>T1098 Account Manipulation</td>
                    </tr>
                    <tr>
                        <td><strong>4756</strong></td>
                        <td>Member Added to Universal Group</td>
                        <td>Enterprise admin changes</td>
                        <td>T1098 Account Manipulation</td>
                    </tr>
                </tbody>
            </table>

            <div class="code-block" data-language="kql">
                <div class="code-header">
                    <span class="code-lang">KQL</span>
                    <span class="code-title">Privileged Group Membership Changes</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <pre><code>// Monitor additions to privileged groups
let PrivilegedGroups = dynamic([
    "Domain Admins",
    "Enterprise Admins",
    "Schema Admins",
    "Administrators",
    "Backup Operators",
    "Account Operators",
    "Server Operators",
    "Print Operators",
    "DnsAdmins"
]);
SecurityEvent
| where EventID in (4728, 4732, 4756)
| where TargetUserName has_any (PrivilegedGroups)
| project 
    TimeGenerated,
    Computer,
    Action = case(
        EventID == 4728, "Added to Global Security Group",
        EventID == 4732, "Added to Local Security Group",
        EventID == 4756, "Added to Universal Security Group",
        "Unknown"
    ),
    GroupName = TargetUserName,
    MemberAdded = MemberName,
    AddedBy = SubjectUserName,
    AddedByDomain = SubjectDomainName
| extend AlertSeverity = "High"</code></pre>
            </div>
        </section>

                <section class="content-section">
            <h2>Object Access & File Events</h2>
            <p>Monitor file system and object access for data exfiltration, tampering, and persistence mechanisms.</p>

            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Event ID</th>
                        <th>Event Name</th>
                        <th>Detection Use Cases</th>
                        <th>MITRE Technique</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>4656</strong></td>
                        <td>Handle to Object Requested</td>
                        <td>Sensitive file access attempts</td>
                        <td>T1005 Data from Local System</td>
                    </tr>
                    <tr>
                        <td><strong>4663</strong></td>
                        <td>Object Access Attempt</td>
                        <td>File read/write/delete operations</td>
                        <td>T1005 Data from Local System</td>
                    </tr>
                    <tr>
                        <td><strong>4670</strong></td>
                        <td>Permissions on Object Changed</td>
                        <td>ACL modification</td>
                        <td>T1222 File Permissions Modification</td>
                    </tr>
                    <tr>
                        <td><strong>4697</strong></td>
                        <td>Service Installed</td>
                        <td>Service persistence</td>
                        <td>T1543.003 Windows Service</td>
                    </tr>
                    <tr>
                        <td><strong>11 (Sysmon)</strong></td>
                        <td>File Created</td>
                        <td>Malware drops, data staging</td>
                        <td>T1074 Data Staged</td>
                    </tr>
                    <tr>
                        <td><strong>23 (Sysmon)</strong></td>
                        <td>File Delete</td>
                        <td>Anti-forensics, cleanup</td>
                        <td>T1070.004 File Deletion</td>
                    </tr>
                </tbody>
            </table>

            <div class="code-block" data-language="kql">
                <div class="code-header">
                    <span class="code-lang">KQL</span>
                    <span class="code-title">Sensitive File Access Detection</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <pre><code>// Monitor access to sensitive files
let SensitivePaths = dynamic([
    "\\SAM",
    "\\SYSTEM",
    "\\SECURITY",
    "\\ntds.dit",
    "\\config\\SAM",
    "\\Windows\\System32\\config",
    "password",
    "credentials",
    "secret"
]);
SecurityEvent
| where EventID == 4663
| where ObjectName has_any (SensitivePaths)
| where AccessMask has_any ("0x1", "0x20", "0x80", "0x100")  // Read, Execute, ReadAttributes
| project 
    TimeGenerated,
    Computer,
    Account = SubjectUserName,
    ObjectName,
    AccessType = case(
        AccessMask has "0x1", "Read",
        AccessMask has "0x2", "Write",
        AccessMask has "0x20", "Execute",
        AccessMask has "0x10000", "Delete",
        "Other"
    ),
    ProcessName</code></pre>
            </div>
        </section>

                <section class="content-section">
            <h2>Network Events</h2>
            <p>Network connection events help detect lateral movement, command & control, and data exfiltration.</p>

            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Event ID</th>
                        <th>Event Name</th>
                        <th>Detection Use Cases</th>
                        <th>MITRE Technique</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>5156</strong></td>
                        <td>WFP Connection Permitted</td>
                        <td>Allowed network connections</td>
                        <td>T1071 Application Layer Protocol</td>
                    </tr>
                    <tr>
                        <td><strong>5157</strong></td>
                        <td>WFP Connection Blocked</td>
                        <td>Blocked connection attempts</td>
                        <td>‚Äî</td>
                    </tr>
                    <tr>
                        <td><strong>5140</strong></td>
                        <td>Network Share Accessed</td>
                        <td>SMB share enumeration, lateral movement</td>
                        <td>T1021.002 SMB/Windows Admin Shares</td>
                    </tr>
                    <tr>
                        <td><strong>5145</strong></td>
                        <td>Network Share Object Checked</td>
                        <td>Detailed share access</td>
                        <td>T1021.002 SMB/Windows Admin Shares</td>
                    </tr>
                    <tr>
                        <td><strong>3 (Sysmon)</strong></td>
                        <td>Network Connection</td>
                        <td>Process network activity</td>
                        <td>T1071 Application Layer Protocol</td>
                    </tr>
                    <tr>
                        <td><strong>22 (Sysmon)</strong></td>
                        <td>DNS Query</td>
                        <td>DNS tunneling, C2 detection</td>
                        <td>T1071.004 DNS</td>
                    </tr>
                </tbody>
            </table>

            <div class="code-block" data-language="kql">
                <div class="code-header">
                    <span class="code-lang">KQL</span>
                    <span class="code-title">Admin Share Access Detection</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <pre><code>// Detect access to administrative shares
SecurityEvent
| where EventID == 5140
| where ShareName in~ ("\\\\*\\C$", "\\\\*\\ADMIN$", "\\\\*\\IPC$")
| where SubjectUserName !endswith "$"  // Exclude machine accounts
| summarize 
    AccessCount = count(),
    UniqueShares = dcount(ShareName),
    ShareList = make_set(ShareName, 10),
    FirstAccess = min(TimeGenerated),
    LastAccess = max(TimeGenerated)
    by Computer, SubjectUserName, IpAddress, bin(TimeGenerated, 1h)
| where AccessCount > 5 or UniqueShares > 2
| extend 
    SuspicionLevel = case(
        UniqueShares > 5 and AccessCount > 20, "High - Possible enumeration",
        ShareName has "C$", "Medium - Admin share access",
        "Low"
    )</code></pre>
            </div>
        </section>

                <section class="content-section">
            <h2>Policy & System Events</h2>
            <p>System and policy events reveal configuration changes, security bypasses, and defense evasion attempts.</p>

            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Event ID</th>
                        <th>Event Name</th>
                        <th>Detection Use Cases</th>
                        <th>MITRE Technique</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>1102</strong></td>
                        <td>Security Log Cleared</td>
                        <td>Anti-forensics, log tampering</td>
                        <td>T1070.001 Clear Windows Event Logs</td>
                    </tr>
                    <tr>
                        <td><strong>4616</strong></td>
                        <td>System Time Changed</td>
                        <td>Timestomping, anti-forensics</td>
                        <td>T1070.006 Timestomp</td>
                    </tr>
                    <tr>
                        <td><strong>4657</strong></td>
                        <td>Registry Value Modified</td>
                        <td>Persistence, config changes</td>
                        <td>T1112 Modify Registry</td>
                    </tr>
                    <tr>
                        <td><strong>4698</strong></td>
                        <td>Scheduled Task Created</td>
                        <td>Persistence mechanism</td>
                        <td>T1053.005 Scheduled Task</td>
                    </tr>
                    <tr>
                        <td><strong>4699</strong></td>
                        <td>Scheduled Task Deleted</td>
                        <td>Anti-forensics, cleanup</td>
                        <td>T1070 Indicator Removal</td>
                    </tr>
                    <tr>
                        <td><strong>4700/4701</strong></td>
                        <td>Scheduled Task Enabled/Disabled</td>
                        <td>Task manipulation</td>
                        <td>T1053.005 Scheduled Task</td>
                    </tr>
                    <tr>
                        <td><strong>4719</strong></td>
                        <td>Audit Policy Changed</td>
                        <td>Defense evasion</td>
                        <td>T1562.002 Disable Windows Event Logging</td>
                    </tr>
                    <tr>
                        <td><strong>7045</strong></td>
                        <td>Service Installed (System)</td>
                        <td>Service persistence</td>
                        <td>T1543.003 Windows Service</td>
                    </tr>
                </tbody>
            </table>

            <div class="code-block" data-language="kql">
                <div class="code-header">
                    <span class="code-lang">KQL</span>
                    <span class="code-title">Security Log Clearing Detection</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <pre><code>// Detect security log clearing - high severity event
SecurityEvent
| where EventID == 1102
| project 
    TimeGenerated,
    Computer,
    ClearedBy = SubjectUserName,
    ClearedByDomain = SubjectDomainName,
    LogonId = SubjectLogonId
| join kind=leftouter (
    SecurityEvent
    | where EventID == 4624
    | project LogonId = TargetLogonId, LogonTime = TimeGenerated, 
        LogonIP = IpAddress, LogonType
) on LogonId
| project
    TimeGenerated,
    Computer,
    ClearedBy,
    ClearedByDomain,
    SourceIP = LogonIP,
    LogonType,
    AlertSeverity = "Critical",
    MITRETechnique = "T1070.001 - Clear Windows Event Logs"</code></pre>
            </div>
        </section>

                <section class="content-section">
            <h2>PowerShell Events</h2>
            <p>PowerShell logging provides visibility into script execution, a common attack vector.</p>

            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Event ID</th>
                        <th>Log</th>
                        <th>Description</th>
                        <th>Detection Use Cases</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>4103</strong></td>
                        <td>PowerShell/Operational</td>
                        <td>Module Logging</td>
                        <td>Cmdlet execution tracking</td>
                    </tr>
                    <tr>
                        <td><strong>4104</strong></td>
                        <td>PowerShell/Operational</td>
                        <td>Script Block Logging</td>
                        <td>Full script content capture (decoded)</td>
                    </tr>
                    <tr>
                        <td><strong>4105/4106</strong></td>
                        <td>PowerShell/Operational</td>
                        <td>Script Block Start/Stop</td>
                        <td>Script execution boundaries</td>
                    </tr>
                    <tr>
                        <td><strong>400/403</strong></td>
                        <td>Windows PowerShell</td>
                        <td>Engine Start/Stop</td>
                        <td>PowerShell session tracking</td>
                    </tr>
                    <tr>
                        <td><strong>800</strong></td>
                        <td>Windows PowerShell</td>
                        <td>Pipeline Execution Details</td>
                        <td>Command execution details</td>
                    </tr>
                </tbody>
            </table>

            <div class="info-box tip">
                <div class="info-box-header">
                    <span class="info-icon">üí°</span>
                    <span>Enable Script Block Logging</span>
                </div>
                <div class="info-box-content">
                    <p>Script Block Logging (4104) captures the full, decoded script content even when obfuscated. Enable via:</p>
                    <p><code>Computer Configuration ‚Üí Administrative Templates ‚Üí Windows Components ‚Üí Windows PowerShell ‚Üí Turn on PowerShell Script Block Logging</code></p>
                </div>
            </div>

            <div class="code-block" data-language="kql">
                <div class="code-header">
                    <span class="code-lang">KQL</span>
                    <span class="code-title">Suspicious PowerShell Script Block Detection</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <pre><code>// Analyze PowerShell script blocks for malicious patterns
Event
| where Source == "Microsoft-Windows-PowerShell"
| where EventID == 4104
| extend ScriptBlock = tostring(EventData)
| where ScriptBlock has_any (
    // Credential access
    "mimikatz", "sekurlsa", "kerberos::list",
    "Get-Credential", "ConvertTo-SecureString",
    // Download/execution
    "DownloadString", "DownloadFile", "Invoke-WebRequest",
    "IEX", "Invoke-Expression", "Start-BitsTransfer",
    // Recon
    "Get-ADUser", "Get-ADComputer", "Get-ADGroup",
    "Get-NetUser", "Get-NetComputer", "Get-NetGroup",
    // Evasion
    "Bypass", "Hidden", "NoProfile",
    "AMSI", "Reflection.Assembly",
    // Persistence
    "New-ScheduledTask", "Register-ScheduledJob",
    "New-Service", "Set-ItemProperty"
)
| extend 
    Category = case(
        ScriptBlock has_any ("mimikatz", "sekurlsa", "kerberos"), "Credential Theft",
        ScriptBlock has_any ("Download", "IEX", "WebRequest"), "Download & Execute",
        ScriptBlock has_any ("Get-AD", "Get-Net"), "Reconnaissance",
        ScriptBlock has_any ("AMSI", "Bypass"), "Defense Evasion",
        ScriptBlock has_any ("ScheduledTask", "Service"), "Persistence",
        "Other"
    )
| project 
    TimeGenerated,
    Computer,
    Category,
    ScriptBlockPreview = substring(ScriptBlock, 0, 500)</code></pre>
            </div>
        </section>

                <section class="content-section">
            <h2>Quick Reference Table</h2>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Category</th>
                        <th>Must-Monitor Events</th>
                        <th>Primary Detection Use</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Authentication</strong></td>
                        <td>4624, 4625, 4648, 4768, 4769, 4776</td>
                        <td>Brute force, Pass-the-Hash, Kerberoasting</td>
                    </tr>
                    <tr>
                        <td><strong>Process</strong></td>
                        <td>4688, Sysmon 1, 10</td>
                        <td>Malicious execution, credential dumping</td>
                    </tr>
                    <tr>
                        <td><strong>Account Mgmt</strong></td>
                        <td>4720, 4728, 4732, 4756</td>
                        <td>Privilege escalation, persistence</td>
                    </tr>
                    <tr>
                        <td><strong>Network</strong></td>
                        <td>5140, 5156, Sysmon 3, 22</td>
                        <td>Lateral movement, C2 communication</td>
                    </tr>
                    <tr>
                        <td><strong>Defense Evasion</strong></td>
                        <td>1102, 4698, 4719, 7045</td>
                        <td>Log clearing, persistence, policy changes</td>
                    </tr>
                    <tr>
                        <td><strong>PowerShell</strong></td>
                        <td>4103, 4104</td>
                        <td>Script-based attacks, obfuscation</td>
                    </tr>
                </tbody>
            </table>
        </section>

                
            </div>
        </main>
    </div>
    <script src="../../js/sidebar.js"></script>
</body>
</html>